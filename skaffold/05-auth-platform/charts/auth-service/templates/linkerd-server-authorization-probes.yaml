apiVersion: policy.linkerd.io/v1beta1
kind: ServerAuthorization
metadata:
  name: {{ include "auth-service.fullname" . }}-allow-probes
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "auth-service.labels" . | nindent 4 }}
    linkerd.policy/component: server-authorization
spec:
  server:
    name: {{ include "auth-service.fullname" . }}-http
  client:
    # Allow unauthenticated kubelet/node probes within cluster CIDRs
    unauthenticated: true
    networks:
      - cidr: 10.244.0.0/16
      - cidr: 10.96.0.0/12
