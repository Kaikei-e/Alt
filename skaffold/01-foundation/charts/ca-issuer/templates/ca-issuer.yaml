# 1. 自己署名CA証明書を発行するための、それ自体を署名者とするIssuer
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: self-signed-issuer
spec:
  selfSigned: {}
---
# 2. 上記のIssuerによって署名される、自己署名のCA証明書本体
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: alt-ca
  namespace: cert-manager
spec:
  isCA: true
  commonName: alt-ca
  secretName: ca-key-pair # CA証明書とキーがこのSecretに保存される
  privateKey:
    algorithm: ECDSA
    size: 256
  issuerRef:
    name: self-signed-issuer
    kind: ClusterIssuer
    group: cert-manager.io
---
# 3. 生成されたCA証明書を使って、他のサービス（Nginx等）の証明書に署名するためのIssuer
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: alt-ca-issuer # Nginxの証明書が参照するIssuer
spec:
  ca:
    secretName: ca-key-pair