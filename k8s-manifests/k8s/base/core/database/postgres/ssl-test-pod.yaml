apiVersion: v1
kind: Pod
metadata:
  name: postgres-ssl-test
  namespace: alt-database
spec:
  containers:
  - name: postgres-client
    image: postgres:15
    command: ["/bin/bash"]
    args: ["-c", "while true; do sleep 30; done;"]
    env:
    - name: PGHOST
      value: "db.alt-database.svc.cluster.local"
    - name: PGPORT
      value: "5432"
    - name: PGUSER
      value: "alt_db_user"
    - name: PGPASSWORD
      valueFrom:
        secretKeyRef:
          name: db-secrets
          key: POSTGRES_PASSWORD
    - name: PGDATABASE
      value: "alt"
    - name: PGSSLMODE
      value: "require"
  restartPolicy: Never