[model]
name        = "sonnet-4"
max_tokens  = 16384
timeout     = "240s"

[permissions]
###############################################################################
# 1. WRITE — Claude がコード生成・リファクタを行ってよい場所
###############################################################################
write = [
  # ─── Go backend ───────────────────────────────────────────────────────────
  "alt-backend/app/cmd/**",            # 起動コード・ルーティングのワイヤリング
  "alt-backend/app/rest/**",           # HTTP ハンドラ（I/O レイヤ）
  "alt-backend/app/gateway/**",        # ACL：外部⇄Domain マッピングのみ
  "alt-backend/app/driver/**",         # DB / 検索エンジンなど具象実装
  "alt-backend/app/utils/**",          # ロガー・HTML パーサ等汎用ユーティリティ
  "alt-backend/app/mocks/**",          # 生成されたモックファイル
  # ─── Front-end ────────────────────────────────────────────────────────────
  "alt-frontend/app/src/**",           # Next.js ソース
  "alt-frontend/app/e2e/**",           # Playwright テスト
  "alt-frontend/app/logic-test/**",    # Vitest ロジックテスト
  # ─── 依存サービスのソース（安全策として固定）──────────────────────
  "pre-processor/**",
  "search-indexer/**",
  "tag-generator/**",
  # ─── インフラ / CI 補助 ───────────────────────────────────────────────
  "compose.yaml",                      # サービス追加時にパッチを許可
  "Dockerfile.*",                      # 個別サービスの Dockerfile
  "Makefile",                          # タスク追記
  # ─── ドキュメント ──────────────────────────────────────────────────
  "README.md",
  "docs/CLAUDE.md",
  ".claude/commands/**"                # 独自 Slash コマンド定義
]

###############################################################################
# 2. EXCLUDE — Claude が **絶対触らない** パス
###############################################################################
exclude = [
  # ─── コアドメイン・ビジネスロジック ──────────────────────────────────
  "alt-backend/app/domain/**",
  "alt-backend/app/usecase/**",
  "alt-backend/app/port/**",
  # ─── 生成物・バイナリ・サードパーティ ───────────────────────────────
  "alt-backend/app/alt-backend-optimized",   # ビルド成果物
  "alt-frontend/app/out/**",                 # Next.js export
  "alt-frontend/app/playwright-report/**",   # E2E レポート
  "alt-frontend/app/node_modules/**",
  "news-creator/models/**",                  # 重量モデル／キャッシュ
  "news-creator/cached_models/**",
  "db/backup.sql",
  # ─── マイグレーションスクリプト ──────────────────────────────────
  "db/migrations/**",                        # 手動レビュー必須
  # ─── Git 管理しない一時ファイル ───────────────────────────────────
  "test-results/**",
  "*.lock",                                  # pnpm-lock.yaml などパッケージロック
  "*.csv",
  "*.json"
]
###############################################################################

[include]               # Modularise rules
files = ["docs/CODERULES.md"]

[ide]
default_editor = "vscode"